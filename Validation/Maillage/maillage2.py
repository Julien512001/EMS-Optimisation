import numpy as np
import matplotlib.pyplot as plt



air = np.arange(20, 310, 10)


# OFFSET = 10, k = 20
# Sweep air
F = np.array([
    34184.71734712, 34175.45255235, 34166.49441506, 34158.03264735,
    34150.16823869, 34142.94197658, 34136.35539926, 34130.3856735,
    34124.99586388, 34120.14185398, 34115.77687406, 34111.85436233,
    34108.32970267, 34105.16119511, 34102.31052636, 34099.74291839,
    34097.42707657, 34095.3350196, 34093.44184476, 34091.72546398,
    34090.16633304, 34088.74718754, 34087.45279363, 34086.26971753,
    34085.18611607, 34084.19154753, 34083.27680303, 34082.4337567,
    34081.65523305
])

I = np.array([
    59.71951644, 59.72761072, 59.73544022, 59.74283872, 59.74971738,
    59.75603998, 59.76180464, 59.76703086, 59.77175057, 59.77600206,
    59.77982599, 59.78326292, 59.78635176, 59.78912889, 59.79162777,
    59.7938788, 59.79590931, 59.79774379, 59.79940403, 59.80090934,
    59.80227683, 59.80352163, 59.80465707, 59.80569492, 59.80664556,
    59.80751812, 59.80832069, 59.80906038, 59.80974348
])


# # OFFSET = 30, k = 20
# # Sweep air
# F2 = np.array([
#     np.nan, np.nan, 34149.91946198, 34141.46082067, 34133.59946012,
#     34126.37583574, 34119.79141917, 34113.82341261, 34108.43494797,
#     34103.58197913, 34099.21779929, 34095.29589888, 34091.77170384,
#     34088.60354745, 34085.75314217, 34083.18573001, 34080.87003191,
#     34078.77807859, 34076.88497646, 34075.16864469, 34073.60954461,
#     34072.19041607, 34070.89602857, 34069.71295094, 34068.62934196,
#     34067.63476152, 34066.72000197, 34065.8769384, 34065.09839602
# ])

# I2 = np.array([
#     np.nan, np.nan, 59.74993502, 59.75733616, 59.76421717,
#     59.77054206, 59.77630903, 59.78153755, 59.78625952,
#     59.79051318, 59.7943392, 59.7977781, 59.80086878,
#     59.80364763, 59.8061481, 59.80840059, 59.81043247,
#     59.81226819, 59.81392957, 59.81543594, 59.8168044,
#     59.81805009, 59.81918636, 59.82022496, 59.8211763,
#     59.82204951, 59.82285267, 59.82359292, 59.82427653
# ])



# OFFSET = 10, k = 80
# Sweep air
F3 = np.array([
    244060.85276546, 245707.49705716, 247196.2679409, 248539.71107029,
    249756.07852193, 250863.31591116, 251877.07277355, 252810.36059217,
    253673.82476843, 254476.15623794, 255224.46030942, 255924.64905301,
    256581.64466273, 257199.54157418, 257781.98332125, 258332.02570583,
    258852.31908934, 259345.16944922, 259812.61265946, 260256.45128425,
    260678.29233682, 261079.56977049, 261461.57144711, 261825.46242894,
    262172.30017158, 262503.04945528, 262818.59152564, 263119.73492579,
    263407.22749592
])

I3 = np.array([
    49.35612754, 49.19046591, 49.0421143, 48.9093899, 48.79014475,
    48.68235296, 48.58428562, 48.49452457, 48.41192051, 48.33554189,
    48.2646313, 48.19856206, 48.13681458, 48.0789578, 48.02461143,
    47.97345701, 47.92521942, 47.87966007, 47.83656921, 47.79576181,
    47.75707355, 47.7203583, 47.68548526, 47.65233655, 47.62080557,
    47.59079542, 47.5622179, 47.53499237, 47.50904455
])


# air = 200, k = 20
# Sweep offset
F4 = np.array([
34072.4462676, 34093.44184476, 34077.592664, 34090.97096626,
34076.29968828, 34076.88497646, 34073.35021712, 34074.35627309,
34071.89402069, 34071.79829505, 34070.97152828, 34071.17243329,
34070.64912926, 34070.46480711, 34070.1876009, 34070.24200567,
34070.00778176, 34069.96979909, 34069.84666257, 34069.86433382,
34069.77176293, 34069.73429019, 34069.67241377, 34069.67520869,
34069.62568711, 34069.60433843, 34069.5696271, 34069.56804965,
34069.53579141, 34069.52623247, 34069.50384345, 34069.50268521,
34069.48236989, 34069.47671998, 34069.46468621, 34069.46081841,
34069.45058312, 34069.44409529, 34069.43536573, np.nan
])

I4 = np.array([
33.02390992, 33.01373989, 33.0214162, 33.01493627,
33.02204266, 33.02175908, 33.02347187, 33.02298435,
33.02417755, 33.02422394, 33.02462463, 33.02452726,
33.02478088, 33.02487021, 33.02500456, 33.02497819,
33.02509171, 33.02511012, 33.0251698, 33.02516123,
33.0252061, 33.02522426, 33.02525425, 33.0252529,
33.0252769, 33.02528725, 33.02530407, 33.02530483,
33.02532047, 33.0253251, 33.02533595, 33.02533652,
33.02534636, 33.0253491, 33.02535493, 33.02535681,
33.02536177, 33.02536491, 33.02536914, np.nan
])




# air = 200, k = 80
# Sweep offset
F5 = np.array([
260131.33308174, 259812.61265946, 259491.48150745, 259494.048045,
259333.18801783, 259301.04664844, 259251.0255508, 259245.65767122,
259217.39631336, 259207.79402127, 259194.99228886, 259192.47277353,
259184.368905, 259180.26083227, 259175.11043025, 259174.07170689,
259170.86677122, 259168.7638529, 259166.44708745, 259165.69855447,
259163.98409529, 259162.99364334, 259161.57874825, 259161.31083593,
259160.38357088, 259159.81133995, 259158.95429401, 259158.83596985,
259158.44143037, 259157.96591631, 259157.57571309, 259157.38412585,
259157.17967845, 259156.86804871, 259156.47798836, 259156.51761371,
259156.35235807, 259156.21137857, 259156.06644694, np.nan
])

I5 = np.array([
47.80725485, 47.83656921, 47.8661599, 47.86592319, 47.8807661, 47.88373351,
47.88835274, 47.88884852, 47.89145901, 47.89234606, 47.89352876, 47.89376154,
47.89451027, 47.89488984, 47.89536573, 47.89546171, 47.89575785, 47.89595216,
47.89616624, 47.89623541, 47.89639383, 47.89648536, 47.8966161, 47.89664086,
47.89672654, 47.89677942, 47.89685862, 47.89686956, 47.89690601, 47.89694996,
47.89698601, 47.89700372, 47.89702261, 47.89705141, 47.89708745, 47.89708379,
47.89709906, 47.89711209, 47.89712548, np.nan
])







err = np.zeros_like(F)
for i in range(len(F)):
    err[i] = 100-100*np.min([F[i],F[-1]])/np.max([F[i],F[-1]])

err3 = np.zeros_like(F3)
for i in range(len(F3)):
    err3[i] = 100-100*np.min([F3[i],F3[-1]])/np.max([F3[i],F3[-1]])



plt.figure()
plt.plot(air, F)
plt.plot(air, F3)
plt.scatter(air, F)
plt.scatter(air, F3)
plt.grid()

plt.figure()
plt.plot(air, err)
plt.plot(air, err3)
plt.scatter(air, err)
plt.scatter(air, err3)
plt.grid()




offset = np.arange(5, 205, 5)
plt.figure()
plt.plot(offset, F4)
plt.scatter(offset, F4, marker="x")
plt.grid()


err4 = np.zeros_like(F4)
for i in range(len(F4)-1):
    err4[i] = 100-100*np.min([F4[i],F4[-2]])/np.max([F4[i],F4[-2]])

err5 = np.zeros_like(F4)
for i in range(len(F4)-1):
    err5[i] = 100-100*np.min([F5[i],F5[-2]])/np.max([F5[i],F5[-2]])


plt.figure()
plt.plot(offset, err4)
plt.plot(offset, err5)
plt.grid()

plt.show()